# .md(Markdown)ファイルについて
## 目次

`[TOC]`
と書くとHaroopadだと自動的に生成してくれます。  
AtoMのMarkdown-tocだと日本語うまく変換できないです。  
docxでやる場合は変換後に設定する。

## 概要

* textファイルの拡張なイメージ。  
* HTMLのようにタグ等記述せずとも`# / *`等を記述すると簡単に装飾できる。  
* GithubやWikiとかで使われてるやつ。

  >Markdown（マークダウン）は、文書を記述するための軽量マークアップ言語のひとつである。本来はプレーンテキスト形式で手軽に書いた文書からHTMLを生成するために開発されたものである。しかし、現在ではHTMLのほかパワーポイント形式やLATEX形式のファイルへ変換するソフトウェア（コンバータ）も開発されている。各コンバータの開発者によって多様な拡張が施されるため、各種の方言が存在する。  
  >
  >[Markdown - ウィキペディア](https://ja.wikipedia.org/wiki/Markdow)

## 利点と欠点

### 利点

* 軽量マークアップ言語
* 中身はtextなのでDiff確認しやすい。(バージョン管理しやすい)
* 簡単なルールだけ決めとくだけでも平仄を合わせやすい  
  (ex.題名：`#`、項目：`##`ぐらいでも)
* 学習工数は30分もかからないである程度書ける。
* 装飾に気を使わないので慣れるとWordより楽
* docx変換(後述)の場合フォーマットと中身が別管理なのでフォーマット変更の対応が容易

### 欠点

* Wordに変換できるけど少し手間。  
  (表紙は使えない後述でヘッダーとかは設定可)
* 興味ないととっつきにくい。  
  (わからない人には渡しづらい)

## 開き方

* ソフト入れたくない場合：  
[DILLINGER](http://dillinger.io/)というオンラインエディタにコピペで編集出来ます。機能としては十分です。
* 既に入ってるエディタの場合：  
  Text形式なのでメモ帳などでも編集可能です。  
    (プレビュー見なくても慣れれば修正できる。)  
  AtoM / VisualStudioCode辺りは標準でプレビュー機能有り、拡張機能入れれば使いやすい。

     AtoMなら`Ctrl + Shift + M`  
     VSCodeなら`Ctrl + Shift + V`

* 専用エディタを入れる：  
  フォルダ内のHaroopadというのが入ってるのでインストール。

## 記法

AtoM / VSCode / Haroopad辺りだとチートシート(記述法)有るんでそっち参照してもらえばいいと思います。

[Markdown記法 サンプル集 - Qiita](http://qiita.com/tbpgr/items/989c6badefff69377da7)

## 出力

>※どの場合でも同様に必ず出力ファイルは確認しましょう。

### PDF

* [DILLINGER](http://dillinger.io/)だとエクスポートでローカルに保存できます
* AtoMだとパッケージいれて`Ctrl + Shift + C`でカレントフォルダに生成してくれます。
* その他もあまり手間なくできると思います。

### docx
1. フォルダ内のPandocというソフトインストール
```
$ pandoc .\INPUT.md -t docx -o OUTPUT.docx
```
  (pandoc標準設定の出力ですが変換自体はこの時点で完了です)

##### テンプレートを使った docx ファイルの作成方法

> 準備(置いてあります)

> まずはテンプレートの`docx`ファイルを作成します。

> ```
> $ pandoc --print-default-data-file reference.docx > reference.docx`
> ```

1. スタイルの編集

  作成された`reference.docx`ファイルを Word で開いて、スタイルを編集します。

  `Heading 1〜6`や``本文``など、使われるスタイル。
  ヘッダーやフッター
  本文の内容は無視されるので、消す必要はありません。

  ホームタブ -> スタイル -> 見出し1(#)右クリック -> 変更で編集できます。

2. docx ファイルの作成

  作成したテンプレートを使って、新しい`docx`ファイルを作成します。

  ```
  $ pandoc INPUT.md --reference-docx=reference.docx -s -o OUTPUT.docx`
  ```

  作成された`new.docx`のレイアウトが`reference.docx`で指定したものになっていれば OK です。

##### batを使った一括変換

* `AllMakeDocx.bat`を叩くと配下のディレクトリを走査して.mdファイルを順次変換していきます。

* 課題としてimageファイルの参照がうまくいかないです。  
  対応できたらバッチを書き換えて下さい。  
  個別フォルダのbat叩くと変換してくれます。
